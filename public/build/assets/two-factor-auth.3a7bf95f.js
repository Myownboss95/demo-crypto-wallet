import{T as v,z as B,p as g,a as l,b as i,d as o,e as t,w as d,i as b,h,t as T,u as n,A,B as f,F,g as V,r as P,C as j}from"./main.2dcdc8d3.js";import{b as q}from"./breadcrumb.9f201b96.js";import{_ as D}from"./FormGroup.23053268.js";import{_ as u}from"./FormButton.a5406ea8.js";import{_}from"./ButtonLoader.1c2761ed.js";import{_ as k}from"./modal.7b24c7e0.js";import"./FormLabel.3e6cbdef.js";import"./FormInput.c55253b9.js";import"./error.71f8f6d4.js";const E={class:"col-lg-4 col-md-4 m-auto mt-5"},H={class:"card shadow"},R={class:"card-body"},L={class:"d-flex justify-content-center align-items-center",style:{"min-height":"300px"}},N={key:0,class:"text-center"},O=t("p",null,"Two factor authentication is enabled.",-1),z={key:1},U={class:"text-center"},G=t("p",null," To enable two factor authentication, click on the button below to get started on the process. ",-1),I=["onSubmit"],J={key:1},K={class:"text-center px-3 py-2"},Q=t("p",null," Download the google authenticator app from App Store or Play store, scan the qr code below ",-1),W={class:"d-flex justify-content-center py-3"},X=["innerHTML"],Y={class:"text-justify"},Z=h(" Alternatively you can use "),tt=h(" as a setup key to create a secure link from authenticator to your account. "),ot=t("p",null," Copy your recovery codes and store them securely as they can be used to disable Two Factor Authentication. ",-1),et={class:"text-center"},st=t("p",null," After set up click on the confirm status button below to enter code from the authenticator app to verify the setup. ",-1),nt={class:""},at={class:"modal-body"},rt={class:"list-group"},ct={class:"copy"},lt=["onClick"],it=t("i",{class:"fa fa-copy"},null,-1),dt=h(" copy "),ut=[it,dt],_t={class:"modal-body"},pt=["onSubmit"],ft=t("p",{class:"text-center"}," Enter the TOTP from the google authenticator app and click the confirm button ",-1),kt={name:"two-factor-auth",props:["auth","errors"],setup(C){const y=C,p=v(),m=v({code:""});B(()=>y.errors,s=>{"confirmTwoFactorAuthentication"in s&&j(s.confirmTwoFactorAuthentication.code)});let a=g(!1),r=g(!1);const x=()=>{p.post(route("two-factor.enable"))},$=()=>{p.delete(route("two-factor.disable"))},w=()=>{m.post(route("two-factor.confirm"),{onSuccess:()=>{document.querySelectorAll(".btn-close").forEach(s=>{s.click()})}})};return(s,e)=>{const S=V("Head");return l(),i(F,null,[o(S,{title:"Two Factor Auth"}),o(q,{title:"Two Factor Auth",crumbs:["Dashboard","Two Factor Auth"]}),t("div",E,[t("div",H,[t("div",R,[t("div",L,[s.$page.props.auth.user.two_factor_status?(l(),i("div",N,[O,o(u,{class:"btn btn-outline-danger",onButtonClicked:$},{default:d(()=>[o(_,{text:"Disable Two Factor Auth",loading:n(p).processing},null,8,["loading"])]),_:1})])):(l(),i("div",z,[s.$page.props.auth.user.two_factor_auth_status===!1?(l(),i("form",{key:0,onSubmit:e[0]||(e[0]=b((...c)=>s.changePassword&&s.changePassword(...c),["prevent"]))},[t("div",U,[G,t("form",{onSubmit:b(x,["prevent"])},[o(u,{class:"btn btn-outline-primary",type:"submit"},{default:d(()=>[o(_,{text:"Enable Two Factor Auth",loading:n(p).processing},null,8,["loading"])]),_:1})],40,I)])],32)):(l(),i("form",J,[t("div",K,[Q,t("div",W,[t("div",{class:"text-center mb-3 p-2 bg-white",innerHTML:s.$page.props.auth.user.two_factor_qr_code_svg},null,8,X)]),t("div",Y,[t("p",null,[Z,t("strong",null,[h(T(s.$page.props.auth.user.two_factor_recovery_codes[0])+" ",1),t("i",{class:"fa fa-copy cursor-pointer",onClick:e[1]||(e[1]=c=>n(A)(s.$page.props.auth.user.two_factor_recovery_codes[0]))})]),tt]),ot,t("div",et,[o(u,{class:"btn btn-outline-success mb-3",onButtonClicked:e[2]||(e[2]=()=>f(a)?a.value=!0:a=!0)},{default:d(()=>[o(_,{text:"Recovery Codes"})]),_:1})]),st]),t("div",nt,[o(u,{class:"btn btn-outline-info mr-auto",onButtonClicked:e[3]||(e[3]=()=>f(r)?r.value=!0:r=!0)},{default:d(()=>[o(_,{text:"Confirm 2FA Status"})]),_:1})])])]))]))])])]),o(k,{title:"Recovery codes",id:"recoveryCodesModal",open:n(a),onModealClosed:e[4]||(e[4]=()=>{f(a)?a.value=!1:a=!1})},{default:d(()=>[t("div",at,[t("ol",rt,[(l(!0),i(F,null,P(y.auth.user.two_factor_recovery_codes,(c,M)=>(l(),i("li",{class:"list-group-item d-flex justify-content-between",key:M},[t("span",ct,T(c),1),t("span",{class:"text-info",onClick:ht=>n(A)(c)},ut,8,lt)]))),128))])])]),_:1},8,["open"]),o(k,{id:"ConfirmTwoFactorModal",size:"sm",title:"Confirm two factor auth",open:n(r),onModealClosed:e[6]||(e[6]=()=>f(r)?r.value=!1:r=!1)},{default:d(()=>[t("div",_t,[t("form",{class:"pb-3",onSubmit:b(w,["prevent"])},[ft,o(D,{placeholder:"TOTP code",modelValue:n(m).code,"onUpdate:modelValue":e[5]||(e[5]=c=>n(m).code=c)},null,8,["modelValue"]),o(u,{class:"btn btn-outline-success w-100",type:"submit"},{default:d(()=>[o(_,{text:"Confirm",loading:w.processing},null,8,["loading"])]),_:1})],40,pt)])]),_:1},8,["open"])])],64)}}};export{kt as default};
